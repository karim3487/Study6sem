-- MySQL Script generated by MySQL Workbench
-- Sat Apr  8 23:08:05 2023
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema hospital
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `hospital` ;

-- -----------------------------------------------------
-- Schema hospital
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `hospital` DEFAULT CHARACTER SET utf8 ;
USE `hospital` ;

-- -----------------------------------------------------
-- Table `hospital`.`doctor_kkr`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `hospital`.`doctor_kkr` ;

CREATE TABLE IF NOT EXISTS `hospital`.`doctor_kkr` (
  `doc_id` INT NOT NULL AUTO_INCREMENT,
  `doc_firstname` VARCHAR(55) NOT NULL,
  `doc_lastname` VARCHAR(55) NOT NULL,
  `doc_surname` VARCHAR(55) NOT NULL,
  `doc_specialty` VARCHAR(55) NOT NULL,
  `doc_phone` VARCHAR(20) NOT NULL,
  `doc_email` VARCHAR(100) NOT NULL,
  `doc_address` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`doc_id`))
ENGINE = InnoDB;

INSERT INTO doctor_kkr VALUES(1, 'Александр', 'Иванов', 'Петрович', 'Терапевт', '+79123456789', 'alex.ivanov@gmail.com', 'ул. Ленина, д. 10');
INSERT INTO doctor_kkr VALUES(2, 'Елена', 'Смирнова', 'Андреевна', 'Стоматолог', '+79234567890', 'elena.smirnova@gmail.com', 'ул. Пушкина, д. 5');
INSERT INTO doctor_kkr VALUES(3, 'Дмитрий', 'Ковалев', 'Васильевич', 'Хирург', '+79345678901', 'dmitry.kovalev@gmail.com', 'ул. Маяковского, д. 20');
INSERT INTO doctor_kkr VALUES(4, 'Светлана', 'Михайлова', 'Ивановна', 'Педиатр', '+79456789012', 'svetlana.mikhailova@gmail.com', 'ул. Горького, д. 15');
INSERT INTO doctor_kkr VALUES(5, 'Андрей', 'Петров', 'Сергеевич', 'Офтальмолог', '+79567890123', 'andrey.petrov@gmail.com', 'ул. Чехова, д. 25');
INSERT INTO doctor_kkr VALUES(6, 'Ольга', 'Соколова', 'Алексеевна', 'Невролог', '+79678901234', 'olga.sokolova@gmail.com', 'ул. Достоевского, д. 30');
INSERT INTO doctor_kkr VALUES(7, 'Иван', 'Николаев', 'Александрович', 'Отоларинголог', '+79789012345', 'ivan.nikolaev@gmail.com', 'ул. Толстого, д. 35');
INSERT INTO doctor_kkr VALUES(8, 'Наталья', 'Кузнецова', 'Анатольевна', 'Гинеколог', '+79890123456', 'natalya.kuznetsova@gmail.com', 'ул. Тургенева, д. 40');
INSERT INTO doctor_kkr VALUES(9, 'Алексей', 'Васильев', 'Дмитриевич', 'Кардиолог', '+79901234567', 'aleksey.vasilyev@gmail.com', 'ул. Лермонтова, д. 45');
INSERT INTO doctor_kkr VALUES(10, 'Мария', 'Казакова', 'Сергеевна', 'Уролог', '+70000000000', 'maria.kazakova@gmail.com', 'ул. Пастернака, д. 50');


-- -----------------------------------------------------
-- Table `hospital`.`insurance_company_kkr`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `hospital`.`insurance_company_kkr` ;

CREATE TABLE IF NOT EXISTS `hospital`.`insurance_company_kkr` (
  `id_ins` INT NOT NULL AUTO_INCREMENT,
  `ins_name` VARCHAR(100) NOT NULL,
  `ins_phone_number` VARCHAR(45) NOT NULL,
  `ins_address` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id_ins`))
ENGINE = InnoDB;

INSERT INTO insurance_company_kkr VALUES(1, 'Согласие', '+7(495)111-11-11', 'Москва, ул. Ленина, д. 10');
INSERT INTO insurance_company_kkr VALUES(2, 'Росгосстрах', '+7(495)222-22-22', 'Москва, ул. Пушкина, д. 5');
INSERT INTO insurance_company_kkr VALUES(3, 'АльфаСтрахование', '+7(495)333-33-33', 'Москва, ул. Маяковского, д. 20');



-- -----------------------------------------------------
-- Table `hospital`.`patient_kkr`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `hospital`.`patient_kkr` ;

CREATE TABLE IF NOT EXISTS `hospital`.`patient_kkr` (
  `pat_id` INT NOT NULL AUTO_INCREMENT,
  `pat_firstname` VARCHAR(55) NOT NULL,
  `pat_lastname` VARCHAR(55) NOT NULL,
  `pat_address` VARCHAR(255) NOT NULL,
  `pat_city` VARCHAR(100) NOT NULL,
  `ins_id` INT NULL,
  PRIMARY KEY (`pat_id`),
  INDEX `fk_patient_kkr_insurance_company_kkr1_idx` (`ins_id` ASC) VISIBLE,
  CONSTRAINT `fk_patient_kkr_insurance_company_kkr1`
    FOREIGN KEY (`ins_id`)
    REFERENCES `hospital`.`insurance_company_kkr` (`id_ins`)
    ON DELETE CASCADE
    ON UPDATE CASCADE )
ENGINE = InnoDB;

INSERT INTO patient_kkr VALUES(1, 'Иван', 'Иванов', 'ул. Ленина, д.1', 'Москва', 1);
INSERT INTO patient_kkr VALUES(2, 'Екатерина', 'Сидорова', 'ул. Пушкина, д.2', 'Санкт-Петербург', 2);
INSERT INTO patient_kkr VALUES(3, 'Алексей', 'Петров', 'ул. Гагарина, д.3', 'Санкт-Петербург', 3);
INSERT INTO patient_kkr VALUES(4, 'Ольга', 'Смирнова', 'ул. Мира, д.4', 'Санкт-Петербург', null);
INSERT INTO patient_kkr VALUES(5, 'Дмитрий', 'Козлов', 'ул. Лермонтова, д.5', 'Санкт-Петербург', 2);
INSERT INTO patient_kkr VALUES(6, 'Мария', 'Волкова', 'ул. Горького, д.6', 'Самара', 3);
INSERT INTO patient_kkr VALUES(7, 'Сергей', 'Петров', 'ул. Ленинградская, д.7', 'Москва', 1);
INSERT INTO patient_kkr VALUES(8, 'Анна', 'Иванова', 'ул. Чехова, д.8', 'Москва', 2);
INSERT INTO patient_kkr VALUES(9, 'Игорь', 'Сидоров', 'ул. Крымская, д.9', 'Москва', null);
INSERT INTO patient_kkr VALUES(10, 'Евгений', 'Федоров', 'ул. Советская, д.10', 'Саратов', null);



-- -----------------------------------------------------
-- Table `hospital`.`doctor_appointment_kkr`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `hospital`.`doctor_appointment_kkr` ;

CREATE TABLE IF NOT EXISTS `hospital`.`doctor_appointment_kkr` (
  `app_id` INT NOT NULL AUTO_INCREMENT,
  `app_date` DATE NOT NULL,
  `app_time` TIME NOT NULL,
  `doc_id` INT NOT NULL,
  `pat_id` INT NOT NULL,
  PRIMARY KEY (`app_id`, `doc_id`, `pat_id`),
  INDEX `fk_doctor_appointment_kkr_doctor_kkr1_idx` (`doc_id` ASC) VISIBLE,
  INDEX `fk_doctor_appointment_kkr_patient_kkr1_idx` (`pat_id` ASC) VISIBLE,
  CONSTRAINT `fk_doctor_appointment_kkr_doctor_kkr1`
    FOREIGN KEY (`doc_id`)
    REFERENCES `hospital`.`doctor_kkr` (`doc_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_doctor_appointment_kkr_patient_kkr1`
    FOREIGN KEY (`pat_id`)
    REFERENCES `hospital`.`patient_kkr` (`pat_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;

INSERT INTO doctor_appointment_kkr (app_date, app_time, doc_id, pat_id)
VALUES ('2023-04-10', '10:00:00', 1, 2),
       ('2023-04-12', '13:30:00', 8, 4),
       ('2023-04-14', '15:45:00', 2, 3),
       ('2023-03-12', '12:30:00', 1, 5),
       ('2023-04-02', '11:00:00', 5, 3),
       ('2023-01-12', '12:30:00', 1, 9),
       ('2023-02-08', '13:30:00', 5, 9),
       ('2023-03-29', '15:00:00', 2, 1),
       ('2023-01-22', '11:00:00', 4, 9),
       ('2023-02-04', '10:45:00', 7, 7);




-- -----------------------------------------------------
-- Table `hospital`.`bill_kkr`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `hospital`.`bill_kkr` ;

CREATE TABLE IF NOT EXISTS `hospital`.`bill_kkr` (
  `bill_id` INT NOT NULL AUTO_INCREMENT,
  `bill_is_amount_insured` TINYINT(1) NOT NULL,
  `bill_date_sent` DATE NOT NULL,
  `bill_amount` DECIMAL(8,2) NOT NULL,
  `bill_status` TINYINT(1) NOT NULL DEFAULT 0,
  `app_id` INT NOT NULL,
  PRIMARY KEY (`bill_id`, `app_id`),
  INDEX `fk_bill_kkr_appointment_kkr1_idx` (`app_id` ASC) VISIBLE,
  CONSTRAINT `fk_bill_kkr_appointment_kkr1`
    FOREIGN KEY (`app_id`)
    REFERENCES `hospital`.`doctor_appointment_kkr` (`app_id`)
    ON DELETE RESTRICT
    ON UPDATE RESTRICT)
ENGINE = InnoDB;

INSERT INTO bill_kkr (bill_is_amount_insured, bill_date_sent, bill_amount, bill_status, app_id)
VALUES (1, '2023-03-15', 250.00, 1, 1),
       (0, '2023-03-20', 890.50, 0, 2),
       (1, '2023-03-25', 230.00, 0, 3),
       (0, '2023-04-01', 520.00, 1, 8),
       (0, '2023-04-01', 520.00, 1, 7),
       (0, '2023-04-01', 520.00, 1, 4),
       (0, '2023-04-01', 520.00, 1, 3),
       (1, '2023-04-05', 750.00, 0, 5);



-- -----------------------------------------------------
-- Table `hospital`.`payment_kkr`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `hospital`.`payment_kkr` ;

CREATE TABLE IF NOT EXISTS `hospital`.`payment_kkr` (
  `pay_id` INT NOT NULL AUTO_INCREMENT,
  `pay_date` DATE NOT NULL,
  `pay_time` TIME NOT NULL,
  `pay_amount` DECIMAL(8,2) NOT NULL,
  `bill_id` INT NOT NULL,
  `ins_id` INT NULL,
  PRIMARY KEY (`pay_id`, `bill_id`),
  INDEX `fk_payment_kkr_bill_kkr1_idx` (`bill_id` ASC) VISIBLE,
  CONSTRAINT `fk_payment_kkr_bill_kkr1`
    FOREIGN KEY (`bill_id`)
    REFERENCES `hospital`.`bill_kkr` (`bill_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE )
ENGINE = InnoDB;

INSERT INTO payment_kkr (pay_date, pay_time, pay_amount, bill_id)
VALUES ('2022-02-15', '09:30:00', 200.00, 1),
       ('2022-03-12', '10:30:00', 500.00, 4),
       ('2023-03-01', '12:30:00', 350.00, 2),
       ('2023-01-05', '15:30:00', 350.00, 2),
       ('2022-12-12', '19:30:00', 350.00, 2);
INSERT INTO payment_kkr (pay_date, pay_time, pay_amount, bill_id, ins_id)
VALUES ('2022-03-15', '12:45:00', 1000.00, 2, 1),
       ('2022-03-15', '12:45:00', 120.00, 3, 2),
       ('2022-03-15', '12:45:00', 200.00, 1, 2),
       ('2022-03-16', '14:00:00', 800.00, 3, 3);


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
